{"version":3,"sources":["../../src/guards/not-authenticated.guard.ts"],"sourcesContent":["import { CanActivate, ExecutionContext, Injectable } from '@nestjs/common';\r\nimport { JwtService } from '@nestjs/jwt';\r\n\r\n@Injectable()\r\nexport class NotAuthenticatedGuard implements CanActivate {\r\n  constructor(private jwtService: JwtService) {}\r\n\r\n  async canActivate(context: ExecutionContext): Promise<boolean> {\r\n    const request = context.switchToHttp().getRequest();\r\n    const authHeader = request.headers.authorization;\r\n    \r\n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\r\n      return true; // Allow access if no token\r\n    }\r\n    \r\n    const token = authHeader.split(' ')[1];\r\n\r\n    try {\r\n      await this.jwtService.verifyAsync(token, {\r\n        secret: process.env.JWT_ACCESS_SECRET,\r\n      });\r\n      return false; // Deny access if token is valid\r\n    } catch {\r\n      return true; // Allow access if token is invalid\r\n    }\r\n  }\r\n}\r\n"],"names":["NotAuthenticatedGuard","canActivate","context","request","switchToHttp","getRequest","authHeader","headers","authorization","startsWith","token","split","jwtService","verifyAsync","secret","process","env","JWT_ACCESS_SECRET"],"mappings":";;;;+BAIaA;;;eAAAA;;;wBAJ6C;qBAC/B;;;;;;;;;;AAGpB,IAAA,AAAMA,wBAAN,MAAMA;IAGX,MAAMC,YAAYC,OAAyB,EAAoB;QAC7D,MAAMC,UAAUD,QAAQE,YAAY,GAAGC,UAAU;QACjD,MAAMC,aAAaH,QAAQI,OAAO,CAACC,aAAa;QAEhD,IAAI,CAACF,cAAc,CAACA,WAAWG,UAAU,CAAC,YAAY;YACpD,OAAO,MAAM,2BAA2B;QAC1C;QAEA,MAAMC,QAAQJ,WAAWK,KAAK,CAAC,IAAI,CAAC,EAAE;QAEtC,IAAI;YACF,MAAM,IAAI,CAACC,UAAU,CAACC,WAAW,CAACH,OAAO;gBACvCI,QAAQC,QAAQC,GAAG,CAACC,iBAAiB;YACvC;YACA,OAAO,OAAO,gCAAgC;QAChD,EAAE,OAAM;YACN,OAAO,MAAM,mCAAmC;QAClD;IACF;IApBA,YAAY,AAAQL,UAAsB,CAAE;aAAxBA,aAAAA;IAAyB;AAqB/C"}