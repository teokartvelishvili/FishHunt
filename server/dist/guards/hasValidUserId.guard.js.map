{"version":3,"sources":["../../src/guards/hasValidUserId.guard.ts"],"sourcesContent":["import { BadRequestException, CanActivate, ExecutionContext, Injectable } from \"@nestjs/common\";\r\nimport { isValidObjectId } from \"mongoose\";\r\nimport { Observable } from \"rxjs\";\r\n\r\n@Injectable()\r\nexport class HasValidUserId implements CanActivate{\r\n  canActivate(context: ExecutionContext): boolean | Promise<boolean> | Observable<boolean> {\r\n    const request = context.switchToHttp().getRequest()\r\n    const headers = request.headers\r\n\r\n    if(!headers['user-id']){\r\n      throw new BadRequestException('user id not provided')\r\n    }\r\n    if(!isValidObjectId(headers['user-id'])){\r\n      throw new BadRequestException('user id is not valid')\r\n    }\r\n\r\n    request.userId = headers['user-id']\r\n    return true\r\n  }\r\n}"],"names":["HasValidUserId","canActivate","context","request","switchToHttp","getRequest","headers","BadRequestException","isValidObjectId","userId"],"mappings":";;;;+BAKaA;;;eAAAA;;;wBALkE;0BAC/C;;;;;;;AAIzB,IAAA,AAAMA,iBAAN,MAAMA;IACXC,YAAYC,OAAyB,EAAoD;QACvF,MAAMC,UAAUD,QAAQE,YAAY,GAAGC,UAAU;QACjD,MAAMC,UAAUH,QAAQG,OAAO;QAE/B,IAAG,CAACA,OAAO,CAAC,UAAU,EAAC;YACrB,MAAM,IAAIC,2BAAmB,CAAC;QAChC;QACA,IAAG,CAACC,IAAAA,yBAAe,EAACF,OAAO,CAAC,UAAU,GAAE;YACtC,MAAM,IAAIC,2BAAmB,CAAC;QAChC;QAEAJ,QAAQM,MAAM,GAAGH,OAAO,CAAC,UAAU;QACnC,OAAO;IACT;AACF"}