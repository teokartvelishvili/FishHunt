{"version":3,"sources":["../../../src/categories/services/size.service.ts"],"sourcesContent":["import {\r\n  Injectable,\r\n  NotFoundException,\r\n  ConflictException,\r\n} from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { Size, SizeDocument } from '../schemas/size.schema';\r\nimport { CreateSizeDto, UpdateSizeDto } from '../dto/size.dto';\r\n\r\n@Injectable()\r\nexport class SizeService {\r\n  constructor(@InjectModel(Size.name) private sizeModel: Model<SizeDocument>) {}\r\n\r\n  async findAll(includeInactive = false): Promise<Size[]> {\r\n    try {\r\n      const filter = includeInactive ? {} : { isActive: true };\r\n      const sizes = await this.sizeModel.find(filter).sort({ value: 1 }).exec();\r\n      console.log(`Size service found ${sizes.length} sizes`);\r\n      return sizes;\r\n    } catch (error) {\r\n      console.error('Error finding sizes:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  async findById(id: string): Promise<Size> {\r\n    const size = await this.sizeModel.findById(id).exec();\r\n    if (!size) {\r\n      throw new NotFoundException(`Size with ID ${id} not found`);\r\n    }\r\n    return size;\r\n  }\r\n\r\n  async create(createSizeDto: CreateSizeDto): Promise<Size> {\r\n    const existingSize = await this.sizeModel\r\n      .findOne({ value: createSizeDto.value })\r\n      .exec();\r\n    if (existingSize) {\r\n      throw new ConflictException(\r\n        `Size with value ${createSizeDto.value} already exists`,\r\n      );\r\n    }\r\n\r\n    const newSize = new this.sizeModel(createSizeDto);\r\n    return newSize.save();\r\n  }\r\n\r\n  async update(id: string, updateSizeDto: UpdateSizeDto): Promise<Size> {\r\n    if (updateSizeDto.value) {\r\n      const existingSize = await this.sizeModel\r\n        .findOne({\r\n          value: updateSizeDto.value,\r\n          _id: { $ne: id },\r\n        })\r\n        .exec();\r\n\r\n      if (existingSize) {\r\n        throw new ConflictException(\r\n          `Size with value ${updateSizeDto.value} already exists`,\r\n        );\r\n      }\r\n    }\r\n\r\n    const updatedSize = await this.sizeModel\r\n      .findByIdAndUpdate(id, updateSizeDto, { new: true })\r\n      .exec();\r\n\r\n    if (!updatedSize) {\r\n      throw new NotFoundException(`Size with ID ${id} not found`);\r\n    }\r\n\r\n    return updatedSize;\r\n  }\r\n\r\n  async remove(id: string): Promise<void> {\r\n    const result = await this.sizeModel.findByIdAndDelete(id).exec();\r\n    if (!result) {\r\n      throw new NotFoundException(`Size with ID ${id} not found`);\r\n    }\r\n  }\r\n}\r\n"],"names":["SizeService","findAll","includeInactive","filter","isActive","sizes","sizeModel","find","sort","value","exec","console","log","length","error","findById","id","size","NotFoundException","create","createSizeDto","existingSize","findOne","ConflictException","newSize","save","update","updateSizeDto","_id","$ne","updatedSize","findByIdAndUpdate","new","remove","result","findByIdAndDelete","name"],"mappings":";;;;+BAWaA;;;eAAAA;;;wBAPN;0BACqB;2BACN;4BACa;;;;;;;;;;;;;;;AAI5B,IAAA,AAAMA,cAAN,MAAMA;IAGX,MAAMC,QAAQC,kBAAkB,KAAK,EAAmB;QACtD,IAAI;YACF,MAAMC,SAASD,kBAAkB,CAAC,IAAI;gBAAEE,UAAU;YAAK;YACvD,MAAMC,QAAQ,MAAM,IAAI,CAACC,SAAS,CAACC,IAAI,CAACJ,QAAQK,IAAI,CAAC;gBAAEC,OAAO;YAAE,GAAGC,IAAI;YACvEC,QAAQC,GAAG,CAAC,CAAC,mBAAmB,EAAEP,MAAMQ,MAAM,CAAC,MAAM,CAAC;YACtD,OAAOR;QACT,EAAE,OAAOS,OAAO;YACdH,QAAQG,KAAK,CAAC,wBAAwBA;YACtC,OAAO,EAAE;QACX;IACF;IAEA,MAAMC,SAASC,EAAU,EAAiB;QACxC,MAAMC,OAAO,MAAM,IAAI,CAACX,SAAS,CAACS,QAAQ,CAACC,IAAIN,IAAI;QACnD,IAAI,CAACO,MAAM;YACT,MAAM,IAAIC,yBAAiB,CAAC,CAAC,aAAa,EAAEF,GAAG,UAAU,CAAC;QAC5D;QACA,OAAOC;IACT;IAEA,MAAME,OAAOC,aAA4B,EAAiB;QACxD,MAAMC,eAAe,MAAM,IAAI,CAACf,SAAS,CACtCgB,OAAO,CAAC;YAAEb,OAAOW,cAAcX,KAAK;QAAC,GACrCC,IAAI;QACP,IAAIW,cAAc;YAChB,MAAM,IAAIE,yBAAiB,CACzB,CAAC,gBAAgB,EAAEH,cAAcX,KAAK,CAAC,eAAe,CAAC;QAE3D;QAEA,MAAMe,UAAU,IAAI,IAAI,CAAClB,SAAS,CAACc;QACnC,OAAOI,QAAQC,IAAI;IACrB;IAEA,MAAMC,OAAOV,EAAU,EAAEW,aAA4B,EAAiB;QACpE,IAAIA,cAAclB,KAAK,EAAE;YACvB,MAAMY,eAAe,MAAM,IAAI,CAACf,SAAS,CACtCgB,OAAO,CAAC;gBACPb,OAAOkB,cAAclB,KAAK;gBAC1BmB,KAAK;oBAAEC,KAAKb;gBAAG;YACjB,GACCN,IAAI;YAEP,IAAIW,cAAc;gBAChB,MAAM,IAAIE,yBAAiB,CACzB,CAAC,gBAAgB,EAAEI,cAAclB,KAAK,CAAC,eAAe,CAAC;YAE3D;QACF;QAEA,MAAMqB,cAAc,MAAM,IAAI,CAACxB,SAAS,CACrCyB,iBAAiB,CAACf,IAAIW,eAAe;YAAEK,KAAK;QAAK,GACjDtB,IAAI;QAEP,IAAI,CAACoB,aAAa;YAChB,MAAM,IAAIZ,yBAAiB,CAAC,CAAC,aAAa,EAAEF,GAAG,UAAU,CAAC;QAC5D;QAEA,OAAOc;IACT;IAEA,MAAMG,OAAOjB,EAAU,EAAiB;QACtC,MAAMkB,SAAS,MAAM,IAAI,CAAC5B,SAAS,CAAC6B,iBAAiB,CAACnB,IAAIN,IAAI;QAC9D,IAAI,CAACwB,QAAQ;YACX,MAAM,IAAIhB,yBAAiB,CAAC,CAAC,aAAa,EAAEF,GAAG,UAAU,CAAC;QAC5D;IACF;IApEA,YAAY,AAAgCV,SAA8B,CAAE;aAAhCA,YAAAA;IAAiC;AAqE/E;;;6DArEgC8B"}