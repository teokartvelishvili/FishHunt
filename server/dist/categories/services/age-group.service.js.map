{"version":3,"sources":["../../../src/categories/services/age-group.service.ts"],"sourcesContent":["import {\r\n  Injectable,\r\n  NotFoundException,\r\n  ConflictException,\r\n} from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { AgeGroup, AgeGroupDocument } from '../schemas/age-group.schema';\r\nimport { CreateAgeGroupDto, UpdateAgeGroupDto } from '../dto/age-group.dto';\r\n\r\n@Injectable()\r\nexport class AgeGroupService {\r\n  constructor(\r\n    @InjectModel(AgeGroup.name) private ageGroupModel: Model<AgeGroupDocument>,\r\n  ) {}\r\n\r\n  async findAll(includeInactive = false): Promise<AgeGroup[]> {\r\n    try {\r\n      const filter = includeInactive ? {} : { isActive: true };\r\n      const ageGroups = await this.ageGroupModel\r\n        .find(filter)\r\n        .sort({ name: 1 })\r\n        .exec();\r\n      console.log(`Age group service found ${ageGroups.length} age groups`);\r\n      return ageGroups;\r\n    } catch (error) {\r\n      console.error('Error finding age groups:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  async findById(id: string): Promise<AgeGroup> {\r\n    const ageGroup = await this.ageGroupModel.findById(id).exec();\r\n    if (!ageGroup) {\r\n      throw new NotFoundException(`Age group with ID ${id} not found`);\r\n    }\r\n    return ageGroup;\r\n  }\r\n\r\n  async findByName(name: string): Promise<AgeGroup | null> {\r\n    try {\r\n      const ageGroup = await this.ageGroupModel.findOne({ name }).exec();\r\n      return ageGroup;\r\n    } catch (error) {\r\n      console.error('Error finding age group by name:', error);\r\n      return null;\r\n    }\r\n  }\r\n  async create(createAgeGroupDto: CreateAgeGroupDto): Promise<AgeGroup> {\r\n    const existingAgeGroup = await this.ageGroupModel\r\n      .findOne({ name: createAgeGroupDto.name })\r\n      .exec();\r\n    if (existingAgeGroup) {\r\n      throw new ConflictException(\r\n        `Age group with name ${createAgeGroupDto.name} already exists`,\r\n      );\r\n    }\r\n\r\n    const newAgeGroup = new this.ageGroupModel(createAgeGroupDto);\r\n    return newAgeGroup.save();\r\n  }\r\n\r\n  async update(\r\n    id: string,\r\n    updateAgeGroupDto: UpdateAgeGroupDto,\r\n  ): Promise<AgeGroup> {\r\n    if (updateAgeGroupDto.name) {\r\n      const existingAgeGroup = await this.ageGroupModel\r\n        .findOne({\r\n          name: updateAgeGroupDto.name,\r\n          _id: { $ne: id },\r\n        })\r\n        .exec();\r\n\r\n      if (existingAgeGroup) {\r\n        throw new ConflictException(\r\n          `Age group with name ${updateAgeGroupDto.name} already exists`,\r\n        );\r\n      }\r\n    }\r\n\r\n    const updatedAgeGroup = await this.ageGroupModel\r\n      .findByIdAndUpdate(id, updateAgeGroupDto, { new: true })\r\n      .exec();\r\n\r\n    if (!updatedAgeGroup) {\r\n      throw new NotFoundException(`Age group with ID ${id} not found`);\r\n    }\r\n\r\n    return updatedAgeGroup;\r\n  }\r\n\r\n  async remove(id: string): Promise<void> {\r\n    const result = await this.ageGroupModel.findByIdAndDelete(id).exec();\r\n    if (!result) {\r\n      throw new NotFoundException(`Age group with ID ${id} not found`);\r\n    }\r\n  }\r\n}\r\n"],"names":["AgeGroupService","findAll","includeInactive","filter","isActive","ageGroups","ageGroupModel","find","sort","name","exec","console","log","length","error","findById","id","ageGroup","NotFoundException","findByName","findOne","create","createAgeGroupDto","existingAgeGroup","ConflictException","newAgeGroup","save","update","updateAgeGroupDto","_id","$ne","updatedAgeGroup","findByIdAndUpdate","new","remove","result","findByIdAndDelete"],"mappings":";;;;+BAWaA;;;eAAAA;;;wBAPN;0BACqB;2BACN;gCACqB;;;;;;;;;;;;;;;AAIpC,IAAA,AAAMA,kBAAN,MAAMA;IAKX,MAAMC,QAAQC,kBAAkB,KAAK,EAAuB;QAC1D,IAAI;YACF,MAAMC,SAASD,kBAAkB,CAAC,IAAI;gBAAEE,UAAU;YAAK;YACvD,MAAMC,YAAY,MAAM,IAAI,CAACC,aAAa,CACvCC,IAAI,CAACJ,QACLK,IAAI,CAAC;gBAAEC,MAAM;YAAE,GACfC,IAAI;YACPC,QAAQC,GAAG,CAAC,CAAC,wBAAwB,EAAEP,UAAUQ,MAAM,CAAC,WAAW,CAAC;YACpE,OAAOR;QACT,EAAE,OAAOS,OAAO;YACdH,QAAQG,KAAK,CAAC,6BAA6BA;YAC3C,OAAO,EAAE;QACX;IACF;IAEA,MAAMC,SAASC,EAAU,EAAqB;QAC5C,MAAMC,WAAW,MAAM,IAAI,CAACX,aAAa,CAACS,QAAQ,CAACC,IAAIN,IAAI;QAC3D,IAAI,CAACO,UAAU;YACb,MAAM,IAAIC,yBAAiB,CAAC,CAAC,kBAAkB,EAAEF,GAAG,UAAU,CAAC;QACjE;QACA,OAAOC;IACT;IAEA,MAAME,WAAWV,IAAY,EAA4B;QACvD,IAAI;YACF,MAAMQ,WAAW,MAAM,IAAI,CAACX,aAAa,CAACc,OAAO,CAAC;gBAAEX;YAAK,GAAGC,IAAI;YAChE,OAAOO;QACT,EAAE,OAAOH,OAAO;YACdH,QAAQG,KAAK,CAAC,oCAAoCA;YAClD,OAAO;QACT;IACF;IACA,MAAMO,OAAOC,iBAAoC,EAAqB;QACpE,MAAMC,mBAAmB,MAAM,IAAI,CAACjB,aAAa,CAC9Cc,OAAO,CAAC;YAAEX,MAAMa,kBAAkBb,IAAI;QAAC,GACvCC,IAAI;QACP,IAAIa,kBAAkB;YACpB,MAAM,IAAIC,yBAAiB,CACzB,CAAC,oBAAoB,EAAEF,kBAAkBb,IAAI,CAAC,eAAe,CAAC;QAElE;QAEA,MAAMgB,cAAc,IAAI,IAAI,CAACnB,aAAa,CAACgB;QAC3C,OAAOG,YAAYC,IAAI;IACzB;IAEA,MAAMC,OACJX,EAAU,EACVY,iBAAoC,EACjB;QACnB,IAAIA,kBAAkBnB,IAAI,EAAE;YAC1B,MAAMc,mBAAmB,MAAM,IAAI,CAACjB,aAAa,CAC9Cc,OAAO,CAAC;gBACPX,MAAMmB,kBAAkBnB,IAAI;gBAC5BoB,KAAK;oBAAEC,KAAKd;gBAAG;YACjB,GACCN,IAAI;YAEP,IAAIa,kBAAkB;gBACpB,MAAM,IAAIC,yBAAiB,CACzB,CAAC,oBAAoB,EAAEI,kBAAkBnB,IAAI,CAAC,eAAe,CAAC;YAElE;QACF;QAEA,MAAMsB,kBAAkB,MAAM,IAAI,CAACzB,aAAa,CAC7C0B,iBAAiB,CAAChB,IAAIY,mBAAmB;YAAEK,KAAK;QAAK,GACrDvB,IAAI;QAEP,IAAI,CAACqB,iBAAiB;YACpB,MAAM,IAAIb,yBAAiB,CAAC,CAAC,kBAAkB,EAAEF,GAAG,UAAU,CAAC;QACjE;QAEA,OAAOe;IACT;IAEA,MAAMG,OAAOlB,EAAU,EAAiB;QACtC,MAAMmB,SAAS,MAAM,IAAI,CAAC7B,aAAa,CAAC8B,iBAAiB,CAACpB,IAAIN,IAAI;QAClE,IAAI,CAACyB,QAAQ;YACX,MAAM,IAAIjB,yBAAiB,CAAC,CAAC,kBAAkB,EAAEF,GAAG,UAAU,CAAC;QACjE;IACF;IArFA,YACE,AAAoCV,aAAsC,CAC1E;aADoCA,gBAAAA;IACnC;AAoFL;;;qEArF0BG"}