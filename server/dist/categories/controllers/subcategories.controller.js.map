{"version":3,"sources":["../../../src/categories/controllers/subcategories.controller.ts"],"sourcesContent":["import {\r\n  Controller,\r\n  Get,\r\n  Post,\r\n  Body,\r\n  Param,\r\n  Put,\r\n  Delete,\r\n  Query,\r\n  UseGuards,\r\n  BadRequestException,\r\n} from '@nestjs/common';\r\nimport { SubCategoryService } from '../services/subCategory.service';\r\nimport {\r\n  CreateSubCategoryDto,\r\n  UpdateSubCategoryDto,\r\n} from '../dto/subcategory.dto';\r\nimport { JwtAuthGuard } from '@/guards/jwt-auth.guard';\r\nimport { RolesGuard } from '@/guards/roles.guard';\r\nimport { Role } from '@/types/role.enum';\r\nimport { Roles } from '@/decorators/roles.decorator';\r\nimport {\r\n  ApiTags,\r\n  ApiOperation,\r\n  ApiResponse,\r\n  ApiParam,\r\n  ApiQuery,\r\n  ApiBearerAuth,\r\n} from '@nestjs/swagger';\r\n\r\n@ApiTags('subcategories')\r\n@Controller('subcategories')\r\nexport class SubCategoriesController {\r\n  constructor(private readonly subCategoryService: SubCategoryService) {}\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get all subcategories' })\r\n  @ApiQuery({\r\n    name: 'categoryId',\r\n    required: false,\r\n    description: 'Filter by category ID',\r\n  })\r\n  @ApiQuery({\r\n    name: 'includeInactive',\r\n    required: false,\r\n    type: Boolean,\r\n    description: 'Include inactive subcategories',\r\n  })\r\n  @ApiResponse({ status: 200, description: 'Returns all subcategories' })\r\n  findAllSubCategories(\r\n    @Query('categoryId') categoryId?: string,\r\n    @Query('includeInactive') includeInactive?: string,\r\n  ) {\r\n    console.log(\r\n      `[SubCategoriesController] GET /categories/sub request. Query params -> categoryId: \"${categoryId}\", includeInactive: \"${includeInactive}\"`,\r\n    );\r\n    try {\r\n      // The service method is async, so this will return a Promise\r\n      const subcategoriesPromise = this.subCategoryService.findAll(\r\n        categoryId,\r\n        includeInactive === 'true',\r\n      );\r\n      console.log(\r\n        `[SubCategoriesController] Called subCategoryService.findAll for categoryId: \"${categoryId}\"`,\r\n      );\r\n      return subcategoriesPromise;\r\n    } catch (error) {\r\n      console.error(\r\n        `[SubCategoriesController] Error in findAllSubCategories for categoryId: \"${categoryId}\":`,\r\n        error.message,\r\n        error.stack,\r\n      );\r\n      throw error; // Rethrow to let NestJS handle the HTTP response\r\n    }\r\n  }\r\n\r\n  @Get(':id')\r\n  @ApiOperation({ summary: 'Get subcategory by ID' })\r\n  @ApiParam({ name: 'id', description: 'Subcategory ID' })\r\n  @ApiResponse({ status: 200, description: 'Returns the subcategory' })\r\n  @ApiResponse({ status: 404, description: 'Subcategory not found' })\r\n  findSubCategoryById(@Param('id') id: string) {\r\n    return this.subCategoryService.findById(id);\r\n  }\r\n\r\n  @Post()\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles(Role.Admin)\r\n  @ApiBearerAuth()\r\n  @ApiOperation({ summary: 'Create a new subcategory' })\r\n  @ApiResponse({\r\n    status: 201,\r\n    description: 'The subcategory has been created successfully',\r\n  })\r\n  @ApiResponse({\r\n    status: 400,\r\n    description: 'Bad Request - Invalid data or duplicate subcategory',\r\n  })\r\n  @ApiResponse({ status: 404, description: 'Category not found' })\r\n  createSubCategory(@Body() createSubCategoryDto: CreateSubCategoryDto) {\r\n    return this.subCategoryService.create(createSubCategoryDto);\r\n  }\r\n\r\n  @Put(':id')\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles(Role.Admin)\r\n  @ApiBearerAuth()\r\n  @ApiOperation({ summary: 'Update a subcategory' })\r\n  @ApiParam({ name: 'id', description: 'Subcategory ID' })\r\n  @ApiResponse({ status: 200, description: 'The subcategory has been updated' })\r\n  @ApiResponse({ status: 404, description: 'Subcategory not found' })\r\n  updateSubCategory(\r\n    @Param('id') id: string,\r\n    @Body() updateSubCategoryDto: UpdateSubCategoryDto,\r\n  ) {\r\n    return this.subCategoryService.update(id, updateSubCategoryDto);\r\n  }\r\n\r\n  @Delete(':id')\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles(Role.Admin)\r\n  @ApiBearerAuth()\r\n  @ApiOperation({ summary: 'Delete a subcategory' })\r\n  @ApiParam({ name: 'id', description: 'Subcategory ID' })\r\n  @ApiResponse({ status: 200, description: 'The subcategory has been deleted' })\r\n  @ApiResponse({ status: 404, description: 'Subcategory not found' })\r\n  removeSubCategory(@Param('id') id: string) {\r\n    return this.subCategoryService.remove(id);\r\n  }\r\n}\r\n"],"names":["SubCategoriesController","findAllSubCategories","categoryId","includeInactive","console","log","subcategoriesPromise","subCategoryService","findAll","error","message","stack","findSubCategoryById","id","findById","createSubCategory","createSubCategoryDto","create","updateSubCategory","updateSubCategoryDto","update","removeSubCategory","remove","summary","name","required","description","type","Boolean","status","Admin"],"mappings":";;;;+BAgCaA;;;eAAAA;;;wBArBN;oCAC4B;gCAI5B;8BACsB;4BACF;0BACN;gCACC;yBAQf;;;;;;;;;;;;;;;AAIA,IAAA,AAAMA,0BAAN,MAAMA;IAiBXC,qBACE,AAAqBC,UAAmB,EACxC,AAA0BC,eAAwB,EAClD;QACAC,QAAQC,GAAG,CACT,CAAC,oFAAoF,EAAEH,WAAW,qBAAqB,EAAEC,gBAAgB,CAAC,CAAC;QAE7I,IAAI;YACF,6DAA6D;YAC7D,MAAMG,uBAAuB,IAAI,CAACC,kBAAkB,CAACC,OAAO,CAC1DN,YACAC,oBAAoB;YAEtBC,QAAQC,GAAG,CACT,CAAC,6EAA6E,EAAEH,WAAW,CAAC,CAAC;YAE/F,OAAOI;QACT,EAAE,OAAOG,OAAO;YACdL,QAAQK,KAAK,CACX,CAAC,yEAAyE,EAAEP,WAAW,EAAE,CAAC,EAC1FO,MAAMC,OAAO,EACbD,MAAME,KAAK;YAEb,MAAMF,OAAO,iDAAiD;QAChE;IACF;IAOAG,oBAAoB,AAAaC,EAAU,EAAE;QAC3C,OAAO,IAAI,CAACN,kBAAkB,CAACO,QAAQ,CAACD;IAC1C;IAgBAE,kBAAkB,AAAQC,oBAA0C,EAAE;QACpE,OAAO,IAAI,CAACT,kBAAkB,CAACU,MAAM,CAACD;IACxC;IAUAE,kBACE,AAAaL,EAAU,EACvB,AAAQM,oBAA0C,EAClD;QACA,OAAO,IAAI,CAACZ,kBAAkB,CAACa,MAAM,CAACP,IAAIM;IAC5C;IAUAE,kBAAkB,AAAaR,EAAU,EAAE;QACzC,OAAO,IAAI,CAACN,kBAAkB,CAACe,MAAM,CAACT;IACxC;IA/FA,YAAY,AAAiBN,kBAAsC,CAAE;aAAxCA,qBAAAA;IAAyC;AAgGxE;;;;QA7FkBgB,SAAS;;;QAEvBC,MAAM;QACNC,UAAU;QACVC,aAAa;;;QAGbF,MAAM;QACNC,UAAU;QACVE,MAAMC;QACNF,aAAa;;;QAEAG,QAAQ;QAAKH,aAAa;;;;;;;;;;;;;;QA6BzBH,SAAS;;;QACbC,MAAM;QAAME,aAAa;;;QACtBG,QAAQ;QAAKH,aAAa;;;QAC1BG,QAAQ;QAAKH,aAAa;;;;;;;;;;;;8CAO7BI;;;QAEIP,SAAS;;;QAEvBM,QAAQ;QACRH,aAAa;;;QAGbG,QAAQ;QACRH,aAAa;;;QAEAG,QAAQ;QAAKH,aAAa;;;;;;;;;;;;8CAO7BI;;;QAEIP,SAAS;;;QACbC,MAAM;QAAME,aAAa;;;QACtBG,QAAQ;QAAKH,aAAa;;;QAC1BG,QAAQ;QAAKH,aAAa;;;;;;;;;;;;;;8CAU7BI;;;QAEIP,SAAS;;;QACbC,MAAM;QAAME,aAAa;;;QACtBG,QAAQ;QAAKH,aAAa;;;QAC1BG,QAAQ;QAAKH,aAAa"}