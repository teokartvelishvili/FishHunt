{"version":3,"sources":["../../src/strategies/google.strategy.ts"],"sourcesContent":["import { Injectable } from '@nestjs/common';\r\nimport { ConfigService } from '@nestjs/config';\r\nimport { PassportStrategy } from '@nestjs/passport';\r\nimport { Strategy } from 'passport-google-oauth2';\r\nimport { Role } from '../types/role.enum';\r\n\r\n@Injectable()\r\nexport class GoogleStrategy extends PassportStrategy(Strategy, 'google') {\r\n  constructor(private configService: ConfigService) {\r\n    super({\r\n      clientID: configService.get('GOOGLE_CLIENT_ID'),\r\n      clientSecret: configService.get('GOOGLE_CLIENT_SECRET'),\r\n      callbackURL: configService.get('GOOGLE_CALLBACK_URL'),\r\n      scope: ['profile', 'email'],\r\n    });\r\n  }\r\n\r\n  async validate(accessToken, refreshToken, profile, done) {\r\n    const user = {\r\n      name: `${profile.given_name} ${profile.family_name}`,\r\n      email: profile.email,\r\n      googleId: profile.id,\r\n      avatar: profile.picture,\r\n      password: '',\r\n      role: Role.User,\r\n    };\r\n\r\n    done(null, user);\r\n  }\r\n}\r\n"],"names":["GoogleStrategy","PassportStrategy","Strategy","validate","accessToken","refreshToken","profile","done","user","name","given_name","family_name","email","googleId","id","avatar","picture","password","role","Role","User","configService","clientID","get","clientSecret","callbackURL","scope"],"mappings":";;;;+BAOaA;;;eAAAA;;;wBAPc;wBACG;0BACG;sCACR;0BACJ;;;;;;;;;;AAGd,IAAA,AAAMA,iBAAN,MAAMA,uBAAuBC,IAAAA,0BAAgB,EAACC,8BAAQ,EAAE;IAU7D,MAAMC,SAASC,WAAW,EAAEC,YAAY,EAAEC,OAAO,EAAEC,IAAI,EAAE;QACvD,MAAMC,OAAO;YACXC,MAAM,GAAGH,QAAQI,UAAU,CAAC,CAAC,EAAEJ,QAAQK,WAAW,EAAE;YACpDC,OAAON,QAAQM,KAAK;YACpBC,UAAUP,QAAQQ,EAAE;YACpBC,QAAQT,QAAQU,OAAO;YACvBC,UAAU;YACVC,MAAMC,cAAI,CAACC,IAAI;QACjB;QAEAb,KAAK,MAAMC;IACb;IApBA,YAAY,AAAQa,aAA4B,CAAE;QAChD,KAAK,CAAC;YACJC,UAAUD,cAAcE,GAAG,CAAC;YAC5BC,cAAcH,cAAcE,GAAG,CAAC;YAChCE,aAAaJ,cAAcE,GAAG,CAAC;YAC/BG,OAAO;gBAAC;gBAAW;aAAQ;QAC7B,SANkBL,gBAAAA;IAOpB;AAcF"}