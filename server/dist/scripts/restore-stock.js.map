{"version":3,"sources":["../../src/scripts/restore-stock.js"],"sourcesContent":["// Script to manually restore stock for deleted orders\r\n// Run this only if you know which products need stock restoration\r\nconst { MongoClient } = require('mongodb');\r\n\r\nasync function restoreStock() {\r\n  const client = new MongoClient(\r\n    process.env.MONGODB_URL || 'mongodb://localhost:27017/fishhunt',\r\n  );\r\n\r\n  try {\r\n    await client.connect();\r\n    console.log('Connected to MongoDB');\r\n\r\n    const db = client.db();\r\n    const productsCollection = db.collection('products');\r\n\r\n    // Example: Restore stock for specific products\r\n    // EDIT THESE VALUES BASED ON YOUR DELETED ORDERS:\r\n    const stockRestorations = [\r\n      // Example:\r\n      // { productId: 'PRODUCT_ID_HERE', size: 'M', color: 'Red', ageGroup: 'Adult', qty: 1 },\r\n      // { productId: 'PRODUCT_ID_HERE', qty: 2 }, // For products without variants\r\n    ];\r\n\r\n    if (stockRestorations.length === 0) {\r\n      console.log(\r\n        'No stock restorations defined. Please edit the script with your specific data.',\r\n      );\r\n      return;\r\n    }\r\n\r\n    for (const restoration of stockRestorations) {\r\n      const { productId, size, color, ageGroup, qty } = restoration;\r\n\r\n      const product = await productsCollection.findOne({ _id: productId });\r\n      if (!product) {\r\n        console.log(`Product ${productId} not found`);\r\n        continue;\r\n      }\r\n\r\n      if (size || color || ageGroup) {\r\n        // Restore variant stock\r\n        const variantIndex = product.variants?.findIndex(\r\n          (v) =>\r\n            v.size === size && v.color === color && v.ageGroup === ageGroup,\r\n        );\r\n\r\n        if (variantIndex >= 0) {\r\n          await productsCollection.updateOne(\r\n            { _id: productId },\r\n            { $inc: { [`variants.${variantIndex}.stock`]: qty } },\r\n          );\r\n          console.log(\r\n            `Restored ${qty} units to variant ${size}/${color}/${ageGroup} of product ${product.name}`,\r\n          );\r\n        } else {\r\n          console.log(`Variant not found for product ${product.name}`);\r\n        }\r\n      } else {\r\n        // Restore general stock\r\n        await productsCollection.updateOne(\r\n          { _id: productId },\r\n          { $inc: { countInStock: qty } },\r\n        );\r\n        console.log(`Restored ${qty} units to product ${product.name}`);\r\n      }\r\n    }\r\n\r\n    console.log('Stock restoration completed');\r\n  } catch (error) {\r\n    console.error('Error:', error);\r\n  } finally {\r\n    await client.close();\r\n  }\r\n}\r\n\r\nrestoreStock();\r\n"],"names":["MongoClient","require","restoreStock","client","process","env","MONGODB_URL","connect","console","log","db","productsCollection","collection","stockRestorations","length","restoration","productId","size","color","ageGroup","qty","product","findOne","_id","variantIndex","variants","findIndex","v","updateOne","$inc","name","countInStock","error","close"],"mappings":";AAAA,sDAAsD;AACtD,kEAAkE;AAClE,MAAM,EAAEA,WAAW,EAAE,GAAGC,QAAQ;AAEhC,eAAeC;IACb,MAAMC,SAAS,IAAIH,YACjBI,QAAQC,GAAG,CAACC,WAAW,IAAI;IAG7B,IAAI;QACF,MAAMH,OAAOI,OAAO;QACpBC,QAAQC,GAAG,CAAC;QAEZ,MAAMC,KAAKP,OAAOO,EAAE;QACpB,MAAMC,qBAAqBD,GAAGE,UAAU,CAAC;QAEzC,+CAA+C;QAC/C,kDAAkD;QAClD,MAAMC,oBAAoB,EAIzB;QAED,IAAIA,kBAAkBC,MAAM,KAAK,GAAG;YAClCN,QAAQC,GAAG,CACT;YAEF;QACF;QAEA,KAAK,MAAMM,eAAeF,kBAAmB;YAC3C,MAAM,EAAEG,SAAS,EAAEC,IAAI,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,GAAG,EAAE,GAAGL;YAElD,MAAMM,UAAU,MAAMV,mBAAmBW,OAAO,CAAC;gBAAEC,KAAKP;YAAU;YAClE,IAAI,CAACK,SAAS;gBACZb,QAAQC,GAAG,CAAC,CAAC,QAAQ,EAAEO,UAAU,UAAU,CAAC;gBAC5C;YACF;YAEA,IAAIC,QAAQC,SAASC,UAAU;gBAC7B,wBAAwB;gBACxB,MAAMK,eAAeH,QAAQI,QAAQ,EAAEC,UACrC,CAACC,IACCA,EAAEV,IAAI,KAAKA,QAAQU,EAAET,KAAK,KAAKA,SAASS,EAAER,QAAQ,KAAKA;gBAG3D,IAAIK,gBAAgB,GAAG;oBACrB,MAAMb,mBAAmBiB,SAAS,CAChC;wBAAEL,KAAKP;oBAAU,GACjB;wBAAEa,MAAM;4BAAE,CAAC,CAAC,SAAS,EAAEL,aAAa,MAAM,CAAC,CAAC,EAAEJ;wBAAI;oBAAE;oBAEtDZ,QAAQC,GAAG,CACT,CAAC,SAAS,EAAEW,IAAI,kBAAkB,EAAEH,KAAK,CAAC,EAAEC,MAAM,CAAC,EAAEC,SAAS,YAAY,EAAEE,QAAQS,IAAI,EAAE;gBAE9F,OAAO;oBACLtB,QAAQC,GAAG,CAAC,CAAC,8BAA8B,EAAEY,QAAQS,IAAI,EAAE;gBAC7D;YACF,OAAO;gBACL,wBAAwB;gBACxB,MAAMnB,mBAAmBiB,SAAS,CAChC;oBAAEL,KAAKP;gBAAU,GACjB;oBAAEa,MAAM;wBAAEE,cAAcX;oBAAI;gBAAE;gBAEhCZ,QAAQC,GAAG,CAAC,CAAC,SAAS,EAAEW,IAAI,kBAAkB,EAAEC,QAAQS,IAAI,EAAE;YAChE;QACF;QAEAtB,QAAQC,GAAG,CAAC;IACd,EAAE,OAAOuB,OAAO;QACdxB,QAAQwB,KAAK,CAAC,UAAUA;IAC1B,SAAU;QACR,MAAM7B,OAAO8B,KAAK;IACpB;AACF;AAEA/B"}