{"version":3,"sources":["../../src/scripts/fix-cloudinary-urls.js"],"sourcesContent":["const { MongoClient } = require('mongodb');\r\n\r\nasync function run() {\r\n  const client = new MongoClient(\r\n    'mongodb+srv://fishhuntgeo:w4fc9PXQLDYwNUUe@ecommerce.ddxri.mongodb.net/?retryWrites=true&w=majority',\r\n  );\r\n\r\n  try {\r\n    await client.connect();\r\n    console.log('Connected to MongoDB');\r\n\r\n    const db = client.db('test');\r\n    const collections = [\r\n      'products',\r\n      'banners',\r\n      'orders',\r\n      'carts',\r\n      'users',\r\n      'categories',\r\n      'subcategories',\r\n    ];\r\n\r\n    for (const colName of collections) {\r\n      const collection = db.collection(colName);\r\n      const docs = await collection.find({}).toArray();\r\n      let count = 0;\r\n\r\n      for (const doc of docs) {\r\n        const originalId = doc._id;\r\n        const str = JSON.stringify(doc);\r\n        if (str.includes('dsufx8uzd')) {\r\n          const newStr = str.replace(/dsufx8uzd/g, 'dqbre9j3o');\r\n          const newDoc = JSON.parse(newStr);\r\n          delete newDoc._id; // Remove _id to avoid immutable field error\r\n          await collection.updateOne({ _id: originalId }, { $set: newDoc });\r\n          count++;\r\n        }\r\n      }\r\n\r\n      console.log(`${colName}: ${count} documents updated`);\r\n    }\r\n\r\n    console.log('Done!');\r\n  } catch (error) {\r\n    console.error('Error:', error);\r\n  } finally {\r\n    await client.close();\r\n  }\r\n}\r\n\r\nrun();\r\n"],"names":["MongoClient","require","run","client","connect","console","log","db","collections","colName","collection","docs","find","toArray","count","doc","originalId","_id","str","JSON","stringify","includes","newStr","replace","newDoc","parse","updateOne","$set","error","close"],"mappings":";AAAA,MAAM,EAAEA,WAAW,EAAE,GAAGC,QAAQ;AAEhC,eAAeC;IACb,MAAMC,SAAS,IAAIH,YACjB;IAGF,IAAI;QACF,MAAMG,OAAOC,OAAO;QACpBC,QAAQC,GAAG,CAAC;QAEZ,MAAMC,KAAKJ,OAAOI,EAAE,CAAC;QACrB,MAAMC,cAAc;YAClB;YACA;YACA;YACA;YACA;YACA;YACA;SACD;QAED,KAAK,MAAMC,WAAWD,YAAa;YACjC,MAAME,aAAaH,GAAGG,UAAU,CAACD;YACjC,MAAME,OAAO,MAAMD,WAAWE,IAAI,CAAC,CAAC,GAAGC,OAAO;YAC9C,IAAIC,QAAQ;YAEZ,KAAK,MAAMC,OAAOJ,KAAM;gBACtB,MAAMK,aAAaD,IAAIE,GAAG;gBAC1B,MAAMC,MAAMC,KAAKC,SAAS,CAACL;gBAC3B,IAAIG,IAAIG,QAAQ,CAAC,cAAc;oBAC7B,MAAMC,SAASJ,IAAIK,OAAO,CAAC,cAAc;oBACzC,MAAMC,SAASL,KAAKM,KAAK,CAACH;oBAC1B,OAAOE,OAAOP,GAAG,EAAE,4CAA4C;oBAC/D,MAAMP,WAAWgB,SAAS,CAAC;wBAAET,KAAKD;oBAAW,GAAG;wBAAEW,MAAMH;oBAAO;oBAC/DV;gBACF;YACF;YAEAT,QAAQC,GAAG,CAAC,GAAGG,QAAQ,EAAE,EAAEK,MAAM,kBAAkB,CAAC;QACtD;QAEAT,QAAQC,GAAG,CAAC;IACd,EAAE,OAAOsB,OAAO;QACdvB,QAAQuB,KAAK,CAAC,UAAUA;IAC1B,SAAU;QACR,MAAMzB,OAAO0B,KAAK;IACpB;AACF;AAEA3B"}