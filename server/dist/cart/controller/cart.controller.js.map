{"version":3,"sources":["../../../src/cart/controller/cart.controller.ts"],"sourcesContent":["import {\r\n  Body,\r\n  Controller,\r\n  Delete,\r\n  Get,\r\n  Param,\r\n  Post,\r\n  Put,\r\n  UseGuards,\r\n  BadRequestException,\r\n} from '@nestjs/common';\r\nimport { JwtAuthGuard } from '../../guards/jwt-auth.guard';\r\nimport { CurrentUser } from '../../decorators/current-user.decorator';\r\nimport { CartService } from '../services/cart.service';\r\nimport { AddToCartDto } from '../dtos/add-to-cart.dto';\r\nimport { SaveShippingDetailsDto } from '../dtos/save-shipping-details.dto';\r\nimport { SavePaymentMethodDto } from '../dtos/save-payment-method.dto';\r\nimport { UserDocument } from '../../users/schemas/user.schema';\r\n\r\n@Controller('cart')\r\n@UseGuards(JwtAuthGuard)\r\nexport class CartController {\r\n  constructor(private cartService: CartService) {}\r\n\r\n  @Get()\r\n  getCart(@CurrentUser() user: UserDocument) {\r\n    return this.cartService.getCart(user);\r\n  }\r\n\r\n  @Post('items')\r\n  addToCart(\r\n    @Body() { productId, qty, size, color, ageGroup, price }: AddToCartDto,\r\n    @CurrentUser() user: UserDocument,\r\n  ) {\r\n    if (!productId) {\r\n      throw new BadRequestException('Product ID is required');\r\n    }\r\n    return this.cartService.addCartItem(\r\n      productId,\r\n      qty,\r\n      user,\r\n      size,\r\n      color,\r\n      ageGroup,\r\n      price,\r\n    );\r\n  }\r\n\r\n  @Put('items/:productId')\r\n  updateCartItem(\r\n    @Param('productId') productId: string,\r\n    @Body()\r\n    { qty, size, color }: { qty: number; size?: string; color?: string },\r\n    @CurrentUser() user: UserDocument,\r\n  ) {\r\n    return this.cartService.updateCartItemQty(\r\n      productId,\r\n      qty,\r\n      user,\r\n      size,\r\n      color,\r\n    );\r\n  }\r\n\r\n  @Delete('items/:productId')\r\n  removeFromCart(\r\n    @Param('productId') productId: string,\r\n    @Body()\r\n    {\r\n      size,\r\n      color,\r\n      ageGroup,\r\n    }: { size?: string; color?: string; ageGroup?: string },\r\n    @CurrentUser() user: UserDocument,\r\n  ) {\r\n    return this.cartService.removeCartItem(\r\n      productId,\r\n      user,\r\n      size,\r\n      color,\r\n      ageGroup,\r\n    );\r\n  }\r\n\r\n  @Post('shipping')\r\n  saveShipping(\r\n    @Body() shippingDetails: SaveShippingDetailsDto,\r\n    @CurrentUser() user: UserDocument,\r\n  ) {\r\n    return this.cartService.validateShippingDetails(shippingDetails);\r\n  }\r\n\r\n  @Post('payment')\r\n  savePaymentMethod(\r\n    @Body() { paymentMethod }: SavePaymentMethodDto,\r\n    @CurrentUser() user: UserDocument,\r\n  ) {\r\n    console.log('Cart controller received payment method:', paymentMethod);\r\n    console.log('Full request body:', { paymentMethod });\r\n    return this.cartService.validatePaymentMethod(paymentMethod);\r\n  }\r\n\r\n  @Delete()\r\n  clearCart(@CurrentUser() user: UserDocument) {\r\n    return this.cartService.clearCart(user);\r\n  }\r\n}\r\n"],"names":["CartController","getCart","user","cartService","addToCart","productId","qty","size","color","ageGroup","price","BadRequestException","addCartItem","updateCartItem","updateCartItemQty","removeFromCart","removeCartItem","saveShipping","shippingDetails","validateShippingDetails","savePaymentMethod","paymentMethod","console","log","validatePaymentMethod","clearCart"],"mappings":";;;;+BAqBaA;;;eAAAA;;;wBAXN;8BACsB;sCACD;6BACA;8BACC;wCACU;sCACF;4BACR;;;;;;;;;;;;;;;AAItB,IAAA,AAAMA,iBAAN,MAAMA;IAIXC,QAAQ,AAAeC,IAAkB,EAAE;QACzC,OAAO,IAAI,CAACC,WAAW,CAACF,OAAO,CAACC;IAClC;IAGAE,UACE,AAAQ,EAAEC,SAAS,EAAEC,GAAG,EAAEC,IAAI,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,KAAK,EAAgB,EACtE,AAAeR,IAAkB,EACjC;QACA,IAAI,CAACG,WAAW;YACd,MAAM,IAAIM,2BAAmB,CAAC;QAChC;QACA,OAAO,IAAI,CAACR,WAAW,CAACS,WAAW,CACjCP,WACAC,KACAJ,MACAK,MACAC,OACAC,UACAC;IAEJ;IAGAG,eACE,AAAoBR,SAAiB,EACrC,AACA,EAAEC,GAAG,EAAEC,IAAI,EAAEC,KAAK,EAAkD,EACpE,AAAeN,IAAkB,EACjC;QACA,OAAO,IAAI,CAACC,WAAW,CAACW,iBAAiB,CACvCT,WACAC,KACAJ,MACAK,MACAC;IAEJ;IAGAO,eACE,AAAoBV,SAAiB,EACrC,AACA,EACEE,IAAI,EACJC,KAAK,EACLC,QAAQ,EAC6C,EACvD,AAAeP,IAAkB,EACjC;QACA,OAAO,IAAI,CAACC,WAAW,CAACa,cAAc,CACpCX,WACAH,MACAK,MACAC,OACAC;IAEJ;IAGAQ,aACE,AAAQC,eAAuC,EAC/C,AAAehB,IAAkB,EACjC;QACA,OAAO,IAAI,CAACC,WAAW,CAACgB,uBAAuB,CAACD;IAClD;IAGAE,kBACE,AAAQ,EAAEC,aAAa,EAAwB,EAC/C,AAAenB,IAAkB,EACjC;QACAoB,QAAQC,GAAG,CAAC,4CAA4CF;QACxDC,QAAQC,GAAG,CAAC,sBAAsB;YAAEF;QAAc;QAClD,OAAO,IAAI,CAAClB,WAAW,CAACqB,qBAAqB,CAACH;IAChD;IAGAI,UAAU,AAAevB,IAAkB,EAAE;QAC3C,OAAO,IAAI,CAACC,WAAW,CAACsB,SAAS,CAACvB;IACpC;IAnFA,YAAY,AAAQC,WAAwB,CAAE;aAA1BA,cAAAA;IAA2B;AAoFjD"}